---
slug: redis-cache
title: "레디스와 캐시"
description: "Redis and Cache"
author: oxahex
createdAt: 2023-09-27
tags: ["note", "redis", "cache"]
---

## Cache
임시로 데이터를 저장하는 공간
원본 데이터가 저장되어 있음에도 같은 데이터를 다른 캐시 서버에 저장해두고 사용하는데, 성능 향상을 기대할 수 있기 때문.
한 번 읽어온 데이터라면 DB까지 요청을 보내지 않고 캐시 서버에서 결과를 바로 리턴해줄 수 있음.
성능 향상 때문이 아니더라도 굳이 DB에 저장하지 않아도 무방한 임시 데이터 등을 처리할 때도 사용할 수 있으나 대체로 캐시 서버를 따로 두는 이유는 성능 향상이 목적.

## Redis
시스템 메모리를 사용해 데이터를 저장하는 key-value 데이터 스토어 솔루션.
데이터 저장 방식과 데이터 저장 위치가 다름.
디스크가 아닌 메모리에 데이터를 저장하므로 MySQL과 같이 디스크에 저장하는 DB에 비해 속도가 빠를 수밖에 없음.
단순 문자열 뿐만 아니라 다양한 형태의 데이터(해시, 리스트)를 저장할 수 있음.
보통 인메모리 기반이라면 서버 종료 시 데이터는 휘발되는데, 레디스는 영속성도 지원을 해줌. 물론 RDB 만큼 안정적이지는 않음.

### 구성
- 단일 노드: Single
- 마스터-슬레이브: Sentinel, Cluster

서버 하나가 죽더라도 나머지 서버들이 지탱하면서 서비스를 계속 운영할 수 있도록 HA(서버 이중화)를 지원해야 할 때, 여러 인스턴스로 클러스터를 구성해서 사용.

3개 서버를 구성한다면, 각 서버에 마스터 노드 1개, 슬레이브 노드 2개가 위치.
1번 서버의 마스터 노드에 데이터 저장 시 2, 3번의 슬레이브 노드에 같은 데이터를 저장.
각 서버는 해당 서버의 데이터와 다른 서버 데이터의 복제본 2개를 가지게 된다.
중복되지 않도록 클러스터를 구성하는 것임.


## Serialization
데이터, 오브젝트와 같은 값들을 바이트 형태로 변환.
자바 오브젝트 형태일 때와 달리 자바 외부에서도 사용할 수 있음. 바이트가 기본 데이터 타입이므로.
Redis는 자바 시스템 외부에 있는 캐시 서버이므로 직렬화 필요.
다시 가져와서 사용하려면 역직렬화 필요.


## 캐싱이 필요한지?
캐싱이 필요한 데이터인지 생각해볼 필요가 있음.
얼마나 자주 요청이 들어오는지?
자주 변경되는 데이터인지? 데이터가 업데이트 될 때마다 캐시 서버 데이터도 업데이트를 해주어야 하는데, 변경이 자주 일어난다면 데이터를 변경하는 데 소요되는 시간도 고려할 필요가 있음.

## 삭제
캐시를 비워야 하는 이유?
캐시 서버에 이미 존재하는 데이터가 실제 DB에 새롭게 업데이트 되었는데, 캐시 서버가 같이 업데이트 되지 않으면 캐시 서버에 Key가 이미 존재하므로 업데이트 이전의 데이터를 가져오게 된다. 메인 DB를 거치지 않음.

### TTL
Time To Live